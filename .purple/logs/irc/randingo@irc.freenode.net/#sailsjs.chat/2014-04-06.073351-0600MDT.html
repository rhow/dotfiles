<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #sailsjs at Sun 06 Apr 2014 07:33:51 AM MDT on randingo@irc.freenode.net (irc)</title></head><body><h3>Conversation with #sailsjs at Sun 06 Apr 2014 07:33:51 AM MDT on randingo@irc.freenode.net (irc)</h3>
<font size="2">(07:33:51 AM)</font><b> The topic for #sailsjs is: npm star sails | <a href="https://www.npmjs.org/package/sails">https://www.npmjs.org/package/sails</a></b><br/>
<font color="#A82F2F"><font size="2">(08:14:08 AM)</font> <b>lenswipe:</b></font> wonder if someone could help me out with sails policies<br/>
<font color="#A82F2F"><font size="2">(08:14:22 AM)</font> <b>lenswipe:</b></font> say I want to list all the widgets a user is permitted to access<br/>
<font color="#A82F2F"><font size="2">(08:14:31 AM)</font> <b>lenswipe:</b></font> this information would be determined by making a request to /widgets<br/>
<font color="#A82F2F"><font size="2">(08:14:53 AM)</font> <b>lenswipe:</b></font> how would i write a policy that filters the widgets to only show the widgets the user has access to?<br/>
<font color="#A82F2F"><font size="2">(08:17:13 AM)</font> <b>mikermcneil:</b></font> hey lenswipe<br/>
<font color="#A82F2F"><font size="2">(08:17:40 AM)</font> <b>mikermcneil:</b></font> accidentally cleared the irc history<br/>
<font color="#A82F2F"><font size="2">(08:17:43 AM)</font> <b>mikermcneil:</b></font> what’s up w/ policies?<br/>
<font color="#A82F2F"><font size="2">(08:23:49 AM)</font> <b>lenswipe:</b></font> hi mikaeldice<br/>
<font color="#A82F2F"><font size="2">(08:23:52 AM)</font> <b>lenswipe:</b></font> okay so<br/>
<font color="#062585"><font size="2">(08:23:57 AM)</font> <b>***lenswipe</b></font> looks at his tab key<br/>
<font color="#A82F2F"><font size="2">(08:24:05 AM)</font> <b>lenswipe:</b></font> mikermcneil, okay, so<br/>
<font color="#A82F2F"><font size="2">(08:24:13 AM)</font> <b>lenswipe:</b></font> i have admins and users right?<br/>
<font color="#A82F2F"><font size="2">(08:24:27 AM)</font> <b>lenswipe:</b></font> actually customer service agents and customers, however...moving on<br/>
<font color="#A82F2F"><font size="2">(08:24:47 AM)</font> <b>lenswipe:</b></font> admins are permitted to only access conversations that are assigned to them, users are only allowed to access the conversation they are part of<br/>
<font color="#A82F2F"><font size="2">(08:25:19 AM)</font> <b>lenswipe:</b></font> to get this list of conversations presumably one would need to make a GET request to /conversations<br/>
<font color="#A82F2F"><font size="2">(08:25:44 AM)</font> <b>lenswipe:</b></font> problem is - that would return ALL conversations, which is not what I want<br/>
<font color="#A82F2F"><font size="2">(08:29:22 AM)</font> <b>mikermcneil:</b></font> right<br/>
<font color="#A82F2F"><font size="2">(08:29:37 AM)</font> <b>mikermcneil:</b></font> so, to start with— easiest option is of couse to write a custom action<br/>
<font color="#A82F2F"><font size="2">(08:30:09 AM)</font> <b>mikermcneil:</b></font> (override ConversationController.find() I mean)<br/>
<font color="#A82F2F"><font size="2">(08:30:24 AM)</font> <b>mikermcneil:</b></font> that’s the “official” approach I’d recommend<br/>
<font color="#A82F2F"><font size="2">(08:30:37 AM)</font> <b>mikermcneil:</b></font> on the other hand, you can get into some stuff w/ policies here<br/>
<font color="#A82F2F"><font size="2">(08:31:07 AM)</font> <b>mikermcneil:</b></font> you could have a policy, i.e. “filterConversationsBasedOnUserRole” or something<br/>
<font color="#A82F2F"><font size="2">(08:33:04 AM)</font> <b>mikermcneil:</b></font> which sets an extra param- so assuming your conversations have a “assignedTo” attribute, you could do:  if (req.session.user.type === ‘admin’) req.query.assignedTo = req.session.user.id; return next()<br/>
<font color="#A82F2F"><font size="2">(08:33:43 AM)</font> <b>mikermcneil:</b></font> at some point, I’d like to make this more powerful by letting you set `req.options.criteria`<br/>
<font color="#A82F2F"><font size="2">(08:33:54 AM)</font> <b>jmcleod:</b></font> morning dudes<br/>
<font color="#A82F2F"><font size="2">(08:34:13 AM)</font> <b>mikermcneil:</b></font> but I’m waiting to play w/ that until after v0.10 is out and some other backlog stuff is caught up<br/>
<font color="#A82F2F"><font size="2">(08:34:19 AM)</font> <b>lenswipe:</b></font> ok<br/>
<font color="#A82F2F"><font size="2">(08:34:21 AM)</font> <b>mikermcneil:</b></font> @jmcleod morning!<br/>
<font color="#A82F2F"><font size="2">(08:34:25 AM)</font> <b>jmcleod:</b></font> :&gt;<br/>
<font color="#A82F2F"><font size="2">(08:34:37 AM)</font> <b>lenswipe:</b></font> so you&apos;re saying the best thing to do is override .find<br/>
<font color="#062585"><font size="2">(08:34:55 AM)</font> <b>***jmcleod</b></font> has a question about .find!<br/>
<font color="#A82F2F"><font size="2">(08:35:15 AM)</font> <b>mikermcneil:</b></font> lenswipe: indeed<br/>
<font color="#A82F2F"><font size="2">(08:35:25 AM)</font> <b>mikermcneil:</b></font> jmcleod: sup<br/>
<font color="#A82F2F"><font size="2">(08:35:39 AM)</font> <b>jmcleod:</b></font> im trying to use .findOne({steamID:’76561198009713860’})<br/>
<font color="#A82F2F"><font size="2">(08:35:55 AM)</font> <b>jmcleod:</b></font> as well as .findOne({steamID:’76561198009713855’})<br/>
<font color="#A82F2F"><font size="2">(08:36:03 AM)</font> <b>jmcleod:</b></font> but… they both find the same record.. the 76561198009713860 one<br/>
<font color="#A82F2F"><font size="2">(08:36:26 AM)</font> <b>jmcleod:</b></font> im trying to confirm that i dont just have some weird scope thing going on<br/>
<font color="#A82F2F"><font size="2">(08:36:43 AM)</font> <b>jmcleod:</b></font> but ive rewritten this a few times, and tried switching the lookup var to be the name and it works that way<br/>
<font color="#A82F2F"><font size="2">(08:38:43 AM)</font> <b>jmcleod:</b></font> http://cl.ly/image/0h053r3x3l2H<br/>
<font color="#A82F2F"><font size="2">(08:39:08 AM)</font> <b>mikermcneil:</b></font> hm what adapter?<br/>
<font color="#A82F2F"><font size="2">(08:39:31 AM)</font> <b>jmcleod:</b></font> disk<br/>
<font color="#A82F2F"><font size="2">(08:39:33 AM)</font> <b>jmcleod:</b></font> for now<br/>
<font color="#A82F2F"><font size="2">(08:39:46 AM)</font> <b>jmcleod:</b></font> ill try mysql<br/>
<font color="#A82F2F"><font size="2">(08:40:08 AM)</font> <b>mikermcneil:</b></font> hm shoudln’t matter<br/>
<font color="#A82F2F"><font size="2">(08:40:11 AM)</font> <b>mikermcneil:</b></font> and what version?<br/>
<font color="#A82F2F"><font size="2">(08:40:14 AM)</font> <b>mikermcneil:</b></font> (of sails i mean)<br/>
<font color="#A82F2F"><font size="2">(08:40:46 AM)</font> <b>mikermcneil:</b></font> ah nvm<br/>
<font color="#A82F2F"><font size="2">(08:40:54 AM)</font> <b>jmcleod:</b></font> 0.9.16<br/>
<font color="#A82F2F"><font size="2">(08:41:05 AM)</font> <b>mikermcneil:</b></font> try typing 76561198009713855 in your javascript console<br/>
<font color="#A82F2F"><font size="2">(08:41:10 AM)</font> <b>jmcleod:</b></font> ive tried with steamID being an integer and a string<br/>
<font color="#A82F2F"><font size="2">(08:41:20 AM)</font> <b>mikermcneil:</b></font> in your attributes?<br/>
<font color="#A82F2F"><font size="2">(08:41:24 AM)</font> <b>jmcleod:</b></font> ha!<br/>
<font color="#A82F2F"><font size="2">(08:41:25 AM)</font> <b>mikermcneil:</b></font> i.e. the model file?<br/>
<font color="#A82F2F"><font size="2">(08:41:28 AM)</font> <b>jmcleod:</b></font> same number?!<br/>
<font color="#A82F2F"><font size="2">(08:41:29 AM)</font> <b>jmcleod:</b></font> yeah<br/>
<font color="#A82F2F"><font size="2">(08:41:38 AM)</font> <b>mikermcneil:</b></font> number precision issue I think<br/>
<font color="#A82F2F"><font size="2">(08:42:02 AM)</font> <b>jmcleod:</b></font> well there we go<br/>
<font color="#A82F2F"><font size="2">(08:42:09 AM)</font> <b>jmcleod:</b></font> but.. a string should work yeah?<br/>
<font color="#A82F2F"><font size="2">(08:42:13 AM)</font> <b>mikermcneil:</b></font> yeah<br/>
<font color="#A82F2F"><font size="2">(08:42:16 AM)</font> <b>mikermcneil:</b></font> what does your model def look like?<br/>
<font color="#A82F2F"><font size="2">(08:42:22 AM)</font> <b>jmcleod:</b></font> let me dump my db file<br/>
<font color="#A82F2F"><font size="2">(08:42:26 AM)</font> <b>jmcleod:</b></font> and kick this thing off again<br/>
<font color="#A82F2F"><font size="2">(08:42:33 AM)</font> <b>mikermcneil:</b></font> k<br/>
<font color="#A82F2F"><font size="2">(08:42:46 AM)</font> <b>mikermcneil:</b></font> do you have steamID: { type: ‘string’ } in your model?<br/>
<font color="#A82F2F"><font size="2">(08:43:17 AM)</font> <b>jmcleod:</b></font> http://cl.ly/image/423i3B191e07<br/>
<font color="#A82F2F"><font size="2">(08:43:21 AM)</font> <b>mikermcneil:</b></font> because otherwise, if it’s schemaless, I’m pretty sure WL / sails-disk will cast number-looking things into numbers<br/>
<font color="#A82F2F"><font size="2">(08:43:40 AM)</font> <b>jmcleod:</b></font> yeah<br/>
<font color="#A82F2F"><font size="2">(08:43:40 AM)</font> <b>mikermcneil:</b></font> hmm - yeah that shouldn’t cast it<br/>
<font color="#A82F2F"><font size="2">(08:43:40 AM)</font> <b>mikermcneil:</b></font> maybe we’re being overeager<br/>
<font color="#A82F2F"><font size="2">(08:43:43 AM)</font> <b>jmcleod:</b></font> brb gatta switch to my phone.. getting called out to go eat haha<br/>
<font color="#A82F2F"><font size="2">(08:43:48 AM)</font> <b>mikermcneil:</b></font> np<br/>
<font color="#A82F2F"><font size="2">(08:45:48 AM)</font> <b>jmcleod:</b></font> k be back in 1 min!<br/>
<font size="2">(08:45:48 AM)</font><b> jmcleod left the room (quit: Quit: jmcleod).</b><br/>
<font color="#A82F2F"><font size="2">(08:53:34 AM)</font> <b>lenswipe:</b></font> mikermcneil, do you know when 0.10 will be released?<br/>
<font color="#A82F2F"><font size="2">(08:54:04 AM)</font> <b>mikermcneil:</b></font> Not sure- it’s really just docs left<br/>
<font color="#A82F2F"><font size="2">(08:54:10 AM)</font> <b>mikermcneil:</b></font> been working on it a lot<br/>
<font color="#A82F2F"><font size="2">(08:54:26 AM)</font> <b>mikermcneil:</b></font> it will be this month though, I can ssure you of that<br/>
<font color="#A82F2F"><font size="2">(08:55:02 AM)</font> <b>Asweb:</b></font> Will we have to do something? if we installed the @beta 0.10<br/>
<font color="#A82F2F"><font size="2">(08:55:10 AM)</font> <b>Asweb:</b></font> I mean a npm install again?<br/>
<font color="#A82F2F"><font size="2">(08:55:42 AM)</font> <b>mikermcneil:</b></font> if you’re using beta, I’d recommend doing npm install every week or so right now to grab the latest stuff<br/>
<font color="#A82F2F"><font size="2">(08:55:52 AM)</font> <b>Asweb:</b></font> ok thanks<br/>
<font color="#A82F2F"><font size="2">(08:55:55 AM)</font> <b>mikermcneil:</b></font> latest sails is rc5<br/>
<font color="#A82F2F"><font size="2">(08:56:22 AM)</font> <b>komlev:</b></font> hey, guys, is there a way to use custom models?<br/>
<font color="#A82F2F"><font size="2">(08:56:37 AM)</font> <b>Asweb:</b></font> I&apos;m getting a small issue, if someone could take a look at : http://pastebin.com/jgjb8Gr7<br/>
<font color="#A82F2F"><font size="2">(08:56:46 AM)</font> <b>Asweb:</b></font> cause I really don&apos;t get the problem --&apos;<br/>
<font color="#A82F2F"><font size="2">(08:56:48 AM)</font> <b>lenswipe:</b></font> mikermcneil, oh wow - that soon<br/>
<font color="#A82F2F"><font size="2">(08:57:57 AM)</font> <b>delight:</b></font> how and where would I register a custom function similar to __ / i18n or low-dash so I can use it in the views ?<br/>
<font color="#A82F2F"><font size="2">(08:58:01 AM)</font> <b>mikermcneil:</b></font> komlev: what do you mean?<br/>
<font color="#A82F2F"><font size="2">(08:59:38 AM)</font> <b>mikermcneil:</b></font> delight: to access any functions or data in your views, set e.g.  res.locals.foo = function () {return ‘bar’;} or res.locals.bar = ‘bar&apos;;<br/>
<font color="#A82F2F"><font size="2">(08:59:56 AM)</font> <b>mikermcneil:</b></font> you can also do this globally (like Express app.locals) as of like last week<br/>
<font color="#A82F2F"><font size="2">(08:59:59 AM)</font> <b>mikermcneil:</b></font> scott added it<br/>
<font color="#A82F2F"><font size="2">(09:00:17 AM)</font> <b>mikermcneil:</b></font> check the commit log- I’m not sure about the usage (that will only be in v0.10)<br/>
<font color="#A82F2F"><font size="2">(09:00:29 AM)</font> <b>mikermcneil:</b></font> Asweb: hmm I don’t see whats wrong<br/>
<font color="#A82F2F"><font size="2">(09:00:44 AM)</font> <b>Asweb:</b></font> Yeah me too^^&apos;<br/>
<font color="#A82F2F"><font size="2">(09:00:45 AM)</font> <b>delight:</b></font> mikermcneil: yes I want to add the custom function globally (sails 0.10) so I have it available in all my views<br/>
<font color="#A82F2F"><font size="2">(09:00:48 AM)</font> <b>mikermcneil:</b></font> to troubleshoot, would you rm -rf .tmp/localDisk*<br/>
<font color="#A82F2F"><font size="2">(09:00:59 AM)</font> <b>mikermcneil:</b></font> cool delight check the commit log in github for usage<br/>
<font color="#A82F2F"><font size="2">(09:01:04 AM)</font> <b>mikermcneil:</b></font> I’m not sure offhand<br/>
<font color="#A82F2F"><font size="2">(09:01:12 AM)</font> <b>delight:</b></font> ok thnx :)<br/>
<font color="#A82F2F"><font size="2">(09:01:56 AM)</font> <b>mikermcneil:</b></font> delight: https://github.com/balderdashy/sails/commit/38b619a09c766d04e78be6e5d28687d6f257a3e1<br/>
<font color="#A82F2F"><font size="2">(09:01:59 AM)</font> <b>mikermcneil:</b></font> from mattliegey<br/>
<font color="#A82F2F"><font size="2">(09:02:07 AM)</font> <b>mikermcneil:</b></font> sails.config.views.locals<br/>
<font color="#A82F2F"><font size="2">(09:02:20 AM)</font> <b>mikermcneil:</b></font> Asweb: also, maybe:<br/>
<font color="#A82F2F"><font size="2">(09:02:23 AM)</font> <b>mikermcneil:</b></font> npm cache clear<br/>
