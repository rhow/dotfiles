<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #sailsjs at Fri 04 Apr 2014 01:58:16 PM MDT on randingo@irc.freenode.net (irc)</title></head><body><h3>Conversation with #sailsjs at Fri 04 Apr 2014 01:58:16 PM MDT on randingo@irc.freenode.net (irc)</h3>
<font size="2">(01:58:16 PM)</font><b> The topic for #sailsjs is: npm star sails | <a href="https://www.npmjs.org/package/sails">https://www.npmjs.org/package/sails</a></b><br/>
<font color="#A82F2F"><font size="2">(02:20:57 PM)</font> <b>zenodub:</b></font> is there a way to do findOne syncronously ?<br/>
<font color="#A82F2F"><font size="2">(02:21:02 PM)</font> <b>zenodub:</b></font> Really don&apos;t wanna do a promise here.<br/>
<font color="#A82F2F"><font size="2">(02:24:22 PM)</font> <b>Asianweb:</b></font> index: function(req,res){     if(req.param(&quot;section&quot;) {  Example.create({     req.param(&quot;section&quot;) : &quot;TEST&quot; }); }  }                      Can I do something like this? add the attribute from variable?<br/>
<font color="#A82F2F"><font size="2">(02:30:32 PM)</font> <b>jdcauley:</b></font> delight, yeah i got it<br/>
<font color="#A82F2F"><font size="2">(02:30:37 PM)</font> <b>jdcauley:</b></font> thanks<br/>
<font color="#A82F2F"><font size="2">(03:10:47 PM)</font> <b>alexandernst:</b></font> I&apos;m deploying sails behind NGINX, but I&apos;m getting 404 when I try to access any file from the assets folder (which are supposed to be accesible)<br/>
<font color="#A82F2F"><font size="2">(03:10:56 PM)</font> <b>alexandernst:</b></font> I don&apos;t get any warnings when I lift on the server<br/>
<font color="#A82F2F"><font size="2">(03:20:47 PM)</font> <b>alexandernst:</b></font> Also, this is happening only when I try to access from port 80 (NGINX is listening there and redirecting to sail&apos;s port). If I try to access via port 20000 (sail&apos;s port) everything works fine<br/>
<font color="#A82F2F"><font size="2">(03:26:03 PM)</font> <b>brandom:</b></font> alexandernst: Are you using a primary/subdomain or a rewrite like domain/sails?<br/>
<font color="#A82F2F"><font size="2">(03:26:14 PM)</font> <b>alexandernst:</b></font> More info: on port 80, I can access /assets/js/whatever<br/>
<font color="#A82F2F"><font size="2">(03:26:24 PM)</font> <b>alexandernst:</b></font> brandom: I&apos;m using a subdomain without any rewrite rules<br/>
<font color="#A82F2F"><font size="2">(03:26:46 PM)</font> <b>brandom:</b></font> Can you pastebin your nginx config?<br/>
<font color="#A82F2F"><font size="2">(03:26:56 PM)</font> <b>alexandernst:</b></font> sure<br/>
<font color="#A82F2F"><font size="2">(03:27:29 PM)</font> <b>alexandernst:</b></font> brandom: http://pastebin.com/nMrWT1mc<br/>
<font color="#A82F2F"><font size="2">(03:29:34 PM)</font> <b>brandom:</b></font> alexandernst: You said you can get to js, so what in your assets is giving you a 404?<br/>
<font color="#A82F2F"><font size="2">(03:30:44 PM)</font> <b>brandom:</b></font> Whatever it is, verify it is being copied to public/.tmp on sails lift which is where the assets are actually served from.<br/>
<font color="#A82F2F"><font size="2">(03:30:49 PM)</font> <b>alexandernst:</b></font> everything is giving 404. In my dev machine I include css/js files liker this:  &lt;script src=&quot;/js/myfile.js&quot;&gt; . That works in my dev machine, but it doesn&apos;t work in my prod machine<br/>
<font color="#A82F2F"><font size="2">(03:31:02 PM)</font> <b>alexandernst:</b></font> yes, everything is copying in .tmp<br/>
<font color="#A82F2F"><font size="2">(03:31:08 PM)</font> <b>alexandernst:</b></font> also, ug+rw<br/>
<font color="#A82F2F"><font size="2">(03:31:19 PM)</font> <b>alexandernst:</b></font> s/copying/copied<br/>
<font color="#A82F2F"><font size="2">(03:31:54 PM)</font> <b>alexandernst:</b></font> even weirder. If I go to the subdomain like this:   st.domain.com  &lt;----- all css/js give 404<br/>
<font color="#A82F2F"><font size="2">(03:32:02 PM)</font> <b>alexandernst:</b></font> but st.domain.com:20000 &lt;----- everything works<br/>
<font color="#A82F2F"><font size="2">(03:35:50 PM)</font> <b>brandom:</b></font> Yeah, I am looking at my config to see if anything is different..<br/>
<font color="#A82F2F"><font size="2">(03:36:16 PM)</font> <b>brandom:</b></font> I had that exact problem on a dev machine trying to serve out of a subdir, but not w/ a subdomain.<br/>
<font color="#A82F2F"><font size="2">(03:37:09 PM)</font> <b>alexandernst:</b></font> I&apos;m like if it wasn&apos;t understanding that it&apos;s behind a proxy (NGINX proxy)<br/>
<font color="#A82F2F"><font size="2">(03:37:26 PM)</font> <b>alexandernst:</b></font> maybe robdubya ^ ?<br/>
<font color="#A82F2F"><font size="2">(03:39:25 PM)</font> <b>zenodub:</b></font>  weird I&apos;m getting a pm2 error that i&apos;m not getting with node app.js or sails lift<br/>
<font color="#A82F2F"><font size="2">(03:39:40 PM)</font> <b>zenodub:</b></font> http://screencloud.net/v/meba<br/>
<font color="#A82F2F"><font size="2">(03:42:47 PM)</font> <b>zenodub:</b></font> seems to work in fork mode, weird<br/>
<font color="#A82F2F"><font size="2">(03:42:55 PM)</font> <b>zenodub:</b></font> never had that problem with sails maybe it&apos;s a version issue<br/>
<font color="#A82F2F"><font size="2">(03:46:10 PM)</font> <b>brandom:</b></font> alexandernst: I can&apos;t pick out exactly what the issue may be, but here is my working config for comparison. http://pastebin.com/vYA86rUR<br/>
<font color="#A82F2F"><font size="2">(03:46:57 PM)</font> <b>brandom:</b></font> The most obvious thing is that I don&apos;t have proxy_redirect off, not sure if that would be a fix though.<br/>
<font color="#A82F2F"><font size="2">(03:48:50 PM)</font> <b>alexandernst:</b></font> trying right now :)<br/>
<font color="#A82F2F"><font size="2">(03:49:13 PM)</font> <b>alexandernst:</b></font> nope<br/>
<font color="#A82F2F"><font size="2">(03:49:59 PM)</font> <b>zenodub:</b></font> ah crap fork mode isnt working either<br/>
<font color="#A82F2F"><font size="2">(03:53:37 PM)</font> <b>robdubya:</b></font> wat<br/>
<font color="#A82F2F"><font size="2">(03:54:21 PM)</font> <b>alexandernst:</b></font> robdubya: nice to see you :)  I think I hit a wall<br/>
<font color="#A82F2F"><font size="2">(03:55:06 PM)</font> <b>brandom:</b></font> alexandernst: Have you tried ripping out all of that pagespeed stuff to narrow down the issue?<br/>
<font color="#A82F2F"><font size="2">(03:56:36 PM)</font> <b>alexandernst:</b></font> brandom: oh f*** me!<br/>
<font color="#A82F2F"><font size="2">(03:56:50 PM)</font> <b>alexandernst:</b></font> it worked, but why?<br/>
<font color="#A82F2F"><font size="2">(03:57:36 PM)</font> <b>brandom:</b></font> Well - I am not familiar with pagespeed but some of the filter rules look like they may be doing something that sails doesn&apos;t like..<br/>
<font color="#A82F2F"><font size="2">(03:58:05 PM)</font> <b>alexandernst:</b></font> well... I&apos;d totally understand it if I was getting messed .js files. But I&apos;m getting 404<br/>
<font color="#A82F2F"><font size="2">(03:58:18 PM)</font> <b>alexandernst:</b></font> ando afaik pagespeed doesn&apos;t do any rewrites<br/>
<font color="#A82F2F"><font size="2">(03:59:28 PM)</font> <b>brandom:</b></font> https://github.com/pagespeed/ngx_pagespeed - bullet point is html rewrites..<br/>
<font color="#A82F2F"><font size="2">(04:00:22 PM)</font> <b>brandom:</b></font> Aside from the image optimization you shouldn&apos;t need any of that in production AFAIK sails follows all of the outlined best practices.<br/>
<font color="#A82F2F"><font size="2">(04:00:54 PM)</font> <b>alexandernst:</b></font> Got it!<br/>
<font color="#A82F2F"><font size="2">(04:00:57 PM)</font> <b>alexandernst:</b></font> 	location ~* \.(js|css|png|jpg|jpeg|gif|icon|woff)$ {<br/>
<font color="#A82F2F"><font size="2">(04:00:57 PM)</font> <b>alexandernst:</b></font> 		expires 1y;<br/>
<font color="#A82F2F"><font size="2">(04:00:57 PM)</font> <b>alexandernst:</b></font> 		add_header Cache-Control public;<br/>
<font color="#A82F2F"><font size="2">(04:00:57 PM)</font> <b>alexandernst:</b></font> 	}<br/>
<font color="#A82F2F"><font size="2">(04:01:12 PM)</font> <b>alexandernst:</b></font> this is causing all the trouble<br/>
<font color="#A82F2F"><font size="2">(04:03:21 PM)</font> <b>brandom:</b></font> I can&apos;t see why adding headers would cause content to 404..<br/>
<font color="#A82F2F"><font size="2">(04:03:31 PM)</font> <b>alexandernst:</b></font> I think I&apos;m guessing why...<br/>
<font color="#A82F2F"><font size="2">(04:03:47 PM)</font> <b>brandom:</b></font> Unless it is conflicting with something pagespeed is doing.<br/>
<font color="#A82F2F"><font size="2">(04:03:54 PM)</font> <b>alexandernst:</b></font> cache-control will make pagespeed use the files from cache (/var/ngx_pagespeed in my conf)<br/>
<font color="#A82F2F"><font size="2">(04:04:04 PM)</font> <b>alexandernst:</b></font> but there are no files there<br/>
<font color="#A82F2F"><font size="2">(04:04:08 PM)</font> <b>brandom:</b></font> Ah. I see.<br/>
<font color="#A82F2F"><font size="2">(04:06:06 PM)</font> <b>alexandernst:</b></font> another question: can I detach &quot;sails lift&quot; from the console? Make it run background, somehow (without using nohup, which seems kind of ugly)<br/>
<font color="#A82F2F"><font size="2">(04:06:27 PM)</font> <b>brandom:</b></font> My personal preference would be the figure out exactly what I needed out of all of those pagespeed filters and get rid of the rest. For example JS combine is useless in a sails app.<br/>
<font color="#A82F2F"><font size="2">(04:06:55 PM)</font> <b>robdubya:</b></font> alexandernst correct me if i&apos;m wrong, but aren&apos;t you buildig a mobile app?<br/>
<font color="#A82F2F"><font size="2">(04:07:03 PM)</font> <b>alexandernst:</b></font> robdubya: yes<br/>
<font color="#A82F2F"><font size="2">(04:07:26 PM)</font> <b>brandom:</b></font> alexandernst: Use forever..<br/>
<font color="#A82F2F"><font size="2">(04:07:57 PM)</font> <b>alexandernst:</b></font> but it turns out I can go for the desktop too (as now I&apos;m not really using anything mobile-only, since the changed we spoke about the other day)<br/>
<font color="#A82F2F"><font size="2">(04:08:25 PM)</font> <b>robdubya:</b></font> mmm<br/>
<font color="#A82F2F"><font size="2">(04:08:30 PM)</font> <b>alexandernst:</b></font> will forever run the same thing that happen when &quot;sails lift&quot; is ran?<br/>
<font color="#A82F2F"><font size="2">(04:08:42 PM)</font> <b>robdubya:</b></font> alexandernst node app is the simplest way<br/>
<font color="#A82F2F"><font size="2">(04:08:49 PM)</font> <b>robdubya:</b></font> forever runs node app as well<br/>
<font color="#A82F2F"><font size="2">(04:14:07 PM)</font> <b>brandom:</b></font> You probably already have it installed and running (gotta love npm), but http://beta.sailsjs.org/#!documentation/guides/deployment has a little more info..<br/>
<font color="#A82F2F"><font size="2">(04:14:59 PM)</font> <b>alexandernst:</b></font> I&apos;m thinking in moving to PM2. Yesterday, after talking with one of the devs, they implemented one of the things I was missing (restart on file changes, aka, watch)<br/>
<font color="#A82F2F"><font size="2">(04:15:15 PM)</font> <b>alexandernst:</b></font> everything erlse in PM2 seems really nice<br/>
<font color="#A82F2F"><font size="2">(04:16:01 PM)</font> <b>brandom:</b></font> Ooo.. I like..<br/>
<font color="#A82F2F"><font size="2">(04:17:15 PM)</font> <b>robdubya:</b></font> the other option is just to keep things seperated<br/>
<font color="#A82F2F"><font size="2">(04:17:22 PM)</font> <b>robdubya:</b></font> just use sails as an API<br/>
<font color="#A82F2F"><font size="2">(04:17:39 PM)</font> <b>alexandernst:</b></font> as API?<br/>
<font color="#A82F2F"><font size="2">(04:17:43 PM)</font> <b>alexandernst:</b></font> what do you mean?<br/>
<font color="#A82F2F"><font size="2">(04:18:12 PM)</font> <b>robdubya:</b></font> dont serve your app from sails (like you&apos;re not going to with your mobile app)<br/>
<font color="#A82F2F"><font size="2">(04:18:18 PM)</font> <b>robdubya:</b></font> just use if for data<br/>
<font color="#A82F2F"><font size="2">(04:18:20 PM)</font> <b>robdubya:</b></font> *it<br/>
<font color="#A82F2F"><font size="2">(04:19:59 PM)</font> <b>brandom:</b></font> alexandernst: You aren&apos;t going to use auto-restart in production, are you?<br/>
<font color="#A82F2F"><font size="2">(04:20:35 PM)</font> <b>alexandernst:</b></font> brandom: in fact, I do. But, there is a trick. I have a really cool deploy-from-tags-after-push setup<br/>
<font color="#A82F2F"><font size="2">(04:20:56 PM)</font> <b>alexandernst:</b></font> basic idea: whenever I tag a revision and push it, my scripts auto-deploy to production<br/>
<font color="#A82F2F"><font size="2">(04:25:52 PM)</font> <b>brandom:</b></font> The auto-deploy sounds nice, but I don&apos;t think the sails team implemented a watch that calls pm2 gracefulReload all which is what you will need to enjoy the 0 downtime benefits claimed..<br/>
<font color="#A82F2F"><font size="2">(04:26:41 PM)</font> <b>brandom:</b></font> Otherwise on every file change that auto reload is going to drop connections.<br/>
<font color="#A82F2F"><font size="2">(04:28:03 PM)</font> <b>robdubya:</b></font> hence why i keep em separated<br/>
<font color="#A82F2F"><font size="2">(04:28:16 PM)</font> <b>robdubya:</b></font> (na na na na you gotta keep &apos;em separated)<br/>
<font color="#A82F2F"><font size="2">(04:28:58 PM)</font> <b>brandom:</b></font> Yeah - or at least don&apos;t use dev grunt tasks in production! :)<br/>
<font color="#A82F2F"><font size="2">(04:31:38 PM)</font> <b>brandom:</b></font> I&apos;m all for automation in dev, but when it comes to prod I want to tell my app what to do and when.<br/>
<font color="#A82F2F"><font size="2">(05:02:23 PM)</font> <b>jdcauley:</b></font> Does anyone have an example of multipart uploads for S3<br/>
<font color="#A82F2F"><font size="2">(05:06:28 PM)</font> <b>robdubya:</b></font> jdcauley https://github.com/balderdashy/skipper<br/>
<font color="#A82F2F"><font size="2">(05:12:49 PM)</font> <b>rawtaz:</b></font> skipper! \o/<br/>
<font size="2">(05:22:28 PM)</font><b> The account has disconnected and you are no longer in this chat. You will be automatically rejoined in the chat when the account reconnects.</b><br/>
</body></html>
