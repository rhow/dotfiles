<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with #sailsjs at Mon 07 Apr 2014 07:21:06 PM MDT on randingo@irc.freenode.net (irc)</title></head><body><h3>Conversation with #sailsjs at Mon 07 Apr 2014 07:21:06 PM MDT on randingo@irc.freenode.net (irc)</h3>
<font size="2">(07:21:06 PM)</font><b> The topic for #sailsjs is: npm star sails | <a href="https://www.npmjs.org/package/sails">https://www.npmjs.org/package/sails</a></b><br/>
<font color="#A82F2F"><font size="2">(07:29:07 PM)</font> <b>beardtree:</b></font> I am unable to access my models/Foo.js from within services/fetchFoo.js which contains only `var a = Foo;` any thoughts? Error message &quot;ReferenceError: Foo is not defined&quot; on that line<br/>
<font color="#16569E"><font size="2">(07:31:34 PM)</font> <b>Randy How:</b></font> in Sailsjs 0.10, where's the config for generating id's that are not simple integer values?<br/>
<font color="#A82F2F"><font size="2">(07:40:30 PM)</font> <b>beardtree:</b></font> Is that even supposed to work?<br/>
<font color="#A82F2F"><font size="2">(07:40:37 PM)</font> <b>beardtree:</b></font> How do I access my models from services?<br/>
<font color="#A82F2F"><font size="2">(07:47:04 PM)</font> <b>lenswipe:</b></font> beardtree, works for me<br/>
<font color="#A82F2F"><font size="2">(07:47:40 PM)</font> <b>lenswipe:</b></font> beardtree, try this: Model.find(&lt;primary_key&gt;).done(sails.log.error);<br/>
<font color="#A82F2F"><font size="2">(07:47:57 PM)</font> <b>beardtree:</b></font> lenswipe: it&apos;s not finding Model at all<br/>
<font color="#A82F2F"><font size="2">(07:48:11 PM)</font> <b>lenswipe:</b></font> yes, you have to change &quot;Model&quot; to the name of your actual model<br/>
<font color="#A82F2F"><font size="2">(07:48:14 PM)</font> <b>lenswipe:</b></font> for example &quot;Foo&quot;<br/>
<font color="#A82F2F"><font size="2">(07:48:18 PM)</font> <b>beardtree:</b></font> I know<br/>
<font color="#A82F2F"><font size="2">(07:48:22 PM)</font> <b>beardtree:</b></font> It&apos;s not finding Foo<br/>
<font color="#A82F2F"><font size="2">(07:48:34 PM)</font> <b>lenswipe:</b></font> paste your code<br/>
<font color="#A82F2F"><font size="2">(07:48:40 PM)</font> <b>lenswipe:</b></font> model and service<br/>
<font color="#A82F2F"><font size="2">(07:48:50 PM)</font> <b>lenswipe:</b></font> plunker is probably best<br/>
<font color="#A82F2F"><font size="2">(07:51:06 PM)</font> <b>beardtree:</b></font> lenswipe: here&apos;s a consistent reproduction: `sails new foo &amp;&amp; cd foo &amp;&amp; sails generate api Foo &amp;&amp; echo &quot;var a = Foo;&quot; &gt; api/services/FooService.js &amp;&amp; sails lift`<br/>
<font color="#A82F2F"><font size="2">(07:53:22 PM)</font> <b>beardtree:</b></font> Can you repro?<br/>
<font color="#A82F2F"><font size="2">(07:54:38 PM)</font> <b>robdubya:</b></font> beardtree models are global, but not until after runtime<br/>
<font color="#A82F2F"><font size="2">(07:54:39 PM)</font> <b>robdubya:</b></font> so<br/>
<font color="#A82F2F"><font size="2">(07:54:50 PM)</font> <b>robdubya:</b></font> doing Module.exports = Foo.someAction() - wont work<br/>
<font color="#A82F2F"><font size="2">(07:54:55 PM)</font> <b>robdubya:</b></font> vs<br/>
<font color="#A82F2F"><font size="2">(07:55:10 PM)</font> <b>robdubya:</b></font> module.exports = function(){ //now Foo is available}<br/>
<font color="#A82F2F"><font size="2">(07:55:22 PM)</font> <b>beardtree:</b></font> robdubya: makes total sense<br/>
<font color="#A82F2F"><font size="2">(07:55:35 PM)</font> <b>beardtree:</b></font> robdubya: is there any way to require() models from outside a sails.js process?<br/>
<font color="#A82F2F"><font size="2">(07:55:51 PM)</font> <b>robdubya:</b></font> mmm<br/>
<font color="#A82F2F"><font size="2">(07:55:56 PM)</font> <b>robdubya:</b></font> for what purpose<br/>
<font color="#A82F2F"><font size="2">(07:56:05 PM)</font> <b>beardtree:</b></font> Say a daemon<br/>
<font color="#A82F2F"><font size="2">(07:56:23 PM)</font> <b>beardtree:</b></font> Ideally I would run these services from outside the sails process<br/>
<font color="#A82F2F"><font size="2">(07:56:39 PM)</font> <b>beardtree:</b></font> Don&apos;t want web servers being bogged down by fetching logic<br/>
<font color="#A82F2F"><font size="2">(07:56:49 PM)</font> <b>robdubya:</b></font> so this is gonna sound smarmy, but thats kinda what http is for...<br/>
<font color="#A82F2F"><font size="2">(07:57:01 PM)</font> <b>robdubya:</b></font> i get what you&apos;re asking<br/>
<font color="#A82F2F"><font size="2">(07:57:34 PM)</font> <b>beardtree:</b></font> This code would run outside the request/response cycle<br/>
<font color="#A82F2F"><font size="2">(07:57:37 PM)</font> <b>robdubya:</b></font> but its not easy - its not really a sails thing vs a node thing<br/>
<font color="#A82F2F"><font size="2">(07:58:03 PM)</font> <b>robdubya:</b></font> what sort of thing? for example, i have a number of (sails) services that use cron<br/>
<font color="#A82F2F"><font size="2">(07:58:15 PM)</font> <b>robdubya:</b></font> but they&apos;re running in the context of sails.<br/>
<font color="#A82F2F"><font size="2">(07:58:52 PM)</font> <b>robdubya:</b></font> you could have a servie that talked to damn near anythin<br/>
<font color="#A82F2F"><font size="2">(07:59:13 PM)</font> <b>robdubya:</b></font> like, even down to the &quot;bare metal&quot; C APIs<br/>
<font color="#A82F2F"><font size="2">(08:00:08 PM)</font> <b>beardtree:</b></font> robdubya: I want to fetch some data from the Internet every 15 minutes, and I don&apos;t want this to happen on the same machine as my web server<br/>
<font color="#A82F2F"><font size="2">(08:00:43 PM)</font> <b>robdubya:</b></font> can i ask why (you odnt want it to run on your web server?)<br/>
<font color="#A82F2F"><font size="2">(08:00:48 PM)</font> <b>robdubya:</b></font> this is node&apos;s bread and butter<br/>
<font color="#A82F2F"><font size="2">(08:01:00 PM)</font> <b>beardtree:</b></font> robdubya: because bandwidth is not infinite<br/>
<font color="#A82F2F"><font size="2">(08:01:19 PM)</font> <b>beardtree:</b></font> When the 15 minute process runs, my web server will not be able to respond to requests as quickly<br/>
<font color="#A82F2F"><font size="2">(08:01:39 PM)</font> <b>beardtree:</b></font> Because the Internet connection is bandwidth-limited<br/>
<font color="#A82F2F"><font size="2">(08:02:13 PM)</font> <b>robdubya:</b></font> (i&apos;d disagree with that premise, but lets go with it for a sec)<br/>
<font color="#A82F2F"><font size="2">(08:02:16 PM)</font> <b>robdubya:</b></font> so your other box<br/>
<font color="#A82F2F"><font size="2">(08:02:23 PM)</font> <b>robdubya:</b></font> the &quot;sync server&quot;<br/>
<font color="#A82F2F"><font size="2">(08:02:27 PM)</font> <b>robdubya:</b></font> is what you mean, i assume<br/>
<font color="#A82F2F"><font size="2">(08:03:10 PM)</font> <b>beardtree:</b></font> robdubya: both the sync server and the web server are bandwidth-limited<br/>
<font color="#A82F2F"><font size="2">(08:03:22 PM)</font> <b>beardtree:</b></font> To about 1MB/s<br/>
<font color="#A82F2F"><font size="2">(08:03:24 PM)</font> <b>robdubya:</b></font> if that&apos;s the case, whats the diff between doing it on one box vs the other?<br/>
<font color="#A82F2F"><font size="2">(08:03:31 PM)</font> <b>robdubya:</b></font> or are you saying they *each* have 1 mb/s<br/>
<font color="#A82F2F"><font size="2">(08:03:36 PM)</font> <b>beardtree:</b></font> Two boxes, double the bandwidth<br/>
<font color="#A82F2F"><font size="2">(08:03:46 PM)</font> <b>beardtree:</b></font> Yes, it&apos;s not shared<br/>
<font color="#A82F2F"><font size="2">(08:04:15 PM)</font> <b>robdubya:</b></font> weird. okay - so how do you envision communicating between them?<br/>
<font color="#A82F2F"><font size="2">(08:04:23 PM)</font> <b>robdubya:</b></font> (if not over http)<br/>
<font color="#A82F2F"><font size="2">(08:04:42 PM)</font> <b>beardtree:</b></font> robdubya: Postgres<br/>
<font color="#A82F2F"><font size="2">(08:05:00 PM)</font> <b>beardtree:</b></font> The sync service updates Postgres which the web service reads from<br/>
<font color="#A82F2F"><font size="2">(08:05:17 PM)</font> <b>robdubya:</b></font> are they all on the same LAN?<br/>
<font color="#A82F2F"><font size="2">(08:05:24 PM)</font> <b>beardtree:</b></font> No<br/>
<font color="#A82F2F"><font size="2">(08:05:42 PM)</font> <b>beardtree:</b></font> These are VPSes<br/>
<font color="#A82F2F"><font size="2">(08:05:58 PM)</font> <b>beardtree:</b></font> Each box has its own allocated bandwidth limit per second<br/>
<font color="#A82F2F"><font size="2">(08:06:16 PM)</font> <b>robdubya:</b></font> where&apos;s the DB live? a seperate VPS? or one of the two?<br/>
<font color="#A82F2F"><font size="2">(08:06:27 PM)</font> <b>beardtree:</b></font> A separate VPS<br/>
<font color="#A82F2F"><font size="2">(08:07:32 PM)</font> <b>robdubya:</b></font> well - thoughts<br/>
<font color="#A82F2F"><font size="2">(08:08:21 PM)</font> <b>robdubya:</b></font> a - the communication between postgres and the server instances â€¦ that&apos;s probabbly happening over the same bandwidth, no? assuming they&apos;re on different lans<br/>
<font color="#A82F2F"><font size="2">(08:09:12 PM)</font> <b>beardtree:</b></font> robdubya: absolutely, the thing is, the web service caches DB requests<br/>
<font color="#A82F2F"><font size="2">(08:09:34 PM)</font> <b>robdubya:</b></font> there&apos;s 2 ways i could see doing this<br/>
<font color="#A82F2F"><font size="2">(08:09:41 PM)</font> <b>beardtree:</b></font> And it&apos;s OK if the sync service gets bogged down<br/>
<font color="#A82F2F"><font size="2">(08:09:57 PM)</font> <b>robdubya:</b></font> (i still think you should investigate doing it all in one - it would be trivial to manage the sync calls<br/>
<font color="#A82F2F"><font size="2">(08:10:01 PM)</font> <b>robdubya:</b></font> but if not<br/>
<font color="#A82F2F"><font size="2">(08:10:18 PM)</font> <b>robdubya:</b></font> are you using all the realtime goodness?<br/>
<font color="#A82F2F"><font size="2">(08:10:21 PM)</font> <b>robdubya:</b></font> (of sails)<br/>
<font color="#A82F2F"><font size="2">(08:10:26 PM)</font> <b>beardtree:</b></font> Oh yes<br/>
<font color="#A82F2F"><font size="2">(08:10:36 PM)</font> <b>robdubya:</b></font> that&apos;s gonna be your issue<br/>
<font color="#A82F2F"><font size="2">(08:10:51 PM)</font> <b>robdubya:</b></font> right now there&apos;s no good way for the database to inform sails that something has changed<br/>
<font color="#A82F2F"><font size="2">(08:11:06 PM)</font> <b>robdubya:</b></font> (you could def use postgres listen/notify, but its not gonna be out of the box)<br/>
<font color="#A82F2F"><font size="2">(08:11:48 PM)</font> <b>beardtree:</b></font> Very interesting<br/>
<font color="#A82F2F"><font size="2">(08:11:50 PM)</font> <b>robdubya:</b></font> eg, writing to the db is out of sails&apos; pubsub context, if that makes sense<br/>
<font color="#A82F2F"><font size="2">(08:12:05 PM)</font> <b>beardtree:</b></font> Maybe it should be?<br/>
<font color="#A82F2F"><font size="2">(08:12:26 PM)</font> <b>robdubya:</b></font> well - afaik only postgres and redis support notify type functionality<br/>
<font color="#A82F2F"><font size="2">(08:12:53 PM)</font> <b>beardtree:</b></font> And CouchDB<br/>
<font color="#A82F2F"><font size="2">(08:12:57 PM)</font> <b>beardtree:</b></font> (Which is not supported)<br/>
<font color="#A82F2F"><font size="2">(08:13:18 PM)</font> <b>beardtree:</b></font> Anyway I get the issue<br/>
<font color="#A82F2F"><font size="2">(08:13:27 PM)</font> <b>robdubya:</b></font> the thing about waterline being cross adapterable is that it has to account for unfortunately the lowest common denominator<br/>
<font color="#A82F2F"><font size="2">(08:13:55 PM)</font> <b>beardtree:</b></font> Thanks for explaining<br/>
<font color="#A82F2F"><font size="2">(08:13:58 PM)</font> <b>robdubya:</b></font> so<br/>
<font color="#A82F2F"><font size="2">(08:14:01 PM)</font> <b>robdubya:</b></font> 2 ways i see<br/>
<font color="#A82F2F"><font size="2">(08:14:15 PM)</font> <b>robdubya:</b></font> write your own plugin / extension to the sails-pg adapter<br/>
<font color="#A82F2F"><font size="2">(08:14:23 PM)</font> <b>robdubya:</b></font> that hooks into listen notify<br/>
<font color="#A82F2F"><font size="2">(08:14:29 PM)</font> <b>robdubya:</b></font> or<br/>
<font color="#A82F2F"><font size="2">(08:14:31 PM)</font> <b>robdubya:</b></font> (the way i do this)<br/>
<font color="#A82F2F"><font size="2">(08:14:44 PM)</font> <b>robdubya:</b></font> have the sync server communicate w/ sails over s.io<br/>
<font color="#A82F2F"><font size="2">(08:15:04 PM)</font> <b>robdubya:</b></font> so the sync server acts like any other web client<br/>
<font color="#A82F2F"><font size="2">(08:15:13 PM)</font> <b>robdubya:</b></font> which plugs into into all the pubsub goodness<br/>
<font color="#A82F2F"><font size="2">(08:15:20 PM)</font> <b>beardtree:</b></font> That&apos;s clever<br/>
<font color="#A82F2F"><font size="2">(08:15:39 PM)</font> <b>robdubya:</b></font> the overhead on a socket connection is way lower than http<br/>
<font color="#A82F2F"><font size="2">(08:16:22 PM)</font> <b>beardtree:</b></font> Back to the original question -- is there some event to listen to that says sails is ready and I can use my models?<br/>
<font color="#A82F2F"><font size="2">(08:16:25 PM)</font> <b>robdubya:</b></font> and if you were *really* bandwidth limited, you could implement a sort of backpressure, where the sails server would say to the sync server &quot;im really fucking busy right now, hold off on requests until i say so)<br/>
<font color="#A82F2F"><font size="2">(08:16:52 PM)</font> <b>beardtree:</b></font> I tried process.nextTick but models weren&apos;t ready<br/>
<font color="#A82F2F"><font size="2">(08:17:12 PM)</font> <b>robdubya:</b></font> config/bootstrap is the best place to fire off processes n stuff<br/>
<font color="#A82F2F"><font size="2">(08:17:26 PM)</font> <b>robdubya:</b></font> its where i start cron jobs<br/>
<font color="#A82F2F"><font size="2">(08:17:28 PM)</font> <b>robdubya:</b></font> for syncing<br/>
<font color="#A82F2F"><font size="2">(08:17:34 PM)</font> <b>beardtree:</b></font> Brilliant<br/>
<font color="#A82F2F"><font size="2">(08:17:50 PM)</font> <b>robdubya:</b></font> i dunno how the remote service you&apos;re pulling from works<br/>
<font color="#A82F2F"><font size="2">(08:18:04 PM)</font> <b>robdubya:</b></font> but my suggestion is to do 11ty tiny requests<br/>
<font color="#A82F2F"><font size="2">(08:18:16 PM)</font> <b>robdubya:</b></font> rather than one GIGANTIC request that the server churns through<br/>
<font color="#A82F2F"><font size="2">(08:18:30 PM)</font> <b>robdubya:</b></font> node&apos;s better at the former<br/>
<font color="#A82F2F"><font size="2">(08:19:47 PM)</font> <b>robdubya:</b></font> the new sails.io.js sdk has built in node functionality, so you could use it to comm between the 2 servers<br/>
<font color="#A82F2F"><font size="2">(08:21:54 PM)</font> <b>lenswipe:</b></font> rob, how would you recommend implementing my pub/sub stuff without ngSails?<br/>
<font color="#A82F2F"><font size="2">(08:22:44 PM)</font> <b>lenswipe:</b></font> because the problem I have right now is that i need to be notified of updates to /Foo, but because I am unable to pass my credentials into ngSails I can&apos;t authenticate meaning I can&apos;t use ngSails<br/>
<font color="#A82F2F"><font size="2">(08:23:03 PM)</font> <b>robdubya:</b></font> why can&apos;t you pass them in<br/>
<font color="#A82F2F"><font size="2">(08:23:48 PM)</font> <b>lenswipe:</b></font> i mean i can pass them in but they don&apos;t seem to be being added to the request<br/>
<font color="#A82F2F"><font size="2">(08:25:30 PM)</font> <b>lenswipe:</b></font> the error that  happens when no username or password aren&apos;t set<br/>
<font color="#A82F2F"><font size="2">(08:25:37 PM)</font> <b>lenswipe:</b></font> you know, the &quot;A username or password is required&quot; one<br/>
<font color="#A82F2F"><font size="2">(08:26:07 PM)</font> <b>lenswipe:</b></font> so either I&apos;m using ngSails wrong (very possible) or ngSails isn&apos;t handling the request params properly (also possible seeing as it&apos;s in beta)<br/>
<font color="#A82F2F"><font size="2">(08:26:51 PM)</font> <b>lenswipe:</b></font> mySailsSocket.get(&apos;/foo&apos;, {username=&apos;toast&apos;, password=&apos;something&apos;).then(function(){});<br/>
<font color="#A82F2F"><font size="2">(08:27:08 PM)</font> <b>robdubya:</b></font> {username : &apos;toast&apos;<br/>
<font color="#A82F2F"><font size="2">(08:27:11 PM)</font> <b>robdubya:</b></font> its just a jsobject<br/>
<font color="#A82F2F"><font size="2">(08:27:15 PM)</font> <b>lenswipe:</b></font> ....i know<br/>
<font color="#A82F2F"><font size="2">(08:27:20 PM)</font> <b>robdubya:</b></font> just checknig...<br/>
<font color="#A82F2F"><font size="2">(08:27:28 PM)</font> <b>lenswipe:</b></font> yeah sorry - i fucked that up in the example<br/>
<font color="#A82F2F"><font size="2">(08:27:40 PM)</font> <b>lenswipe:</b></font> lemme grab the actual code<br/>
<font color="#A82F2F"><font size="2">(08:28:23 PM)</font> <b>lenswipe:</b></font> http://pastebin.com/MWLMKKMi<br/>
<font color="#A82F2F"><font size="2">(08:28:31 PM)</font> <b>lenswipe:</b></font> that&apos;s triggering my &quot;A username or password is required&quot; error<br/>
<font color="#A82F2F"><font size="2">(08:28:54 PM)</font> <b>lenswipe:</b></font> and dumping req.headers out in my auth controller sees the credentials not appearing<br/>
<font color="#A82F2F"><font size="2">(08:28:56 PM)</font> <b>lenswipe:</b></font> same with req.query<br/>
<font color="#A82F2F"><font size="2">(08:32:11 PM)</font> <b>robdubya:</b></font> that code, they&apos;d come in as params<br/>
<font color="#A82F2F"><font size="2">(08:32:31 PM)</font> <b>robdubya:</b></font> (and you should really POST that)<br/>
<font color="#A82F2F"><font size="2">(08:32:41 PM)</font> <b>robdubya:</b></font> as if it was a login form<br/>
<font color="#A82F2F"><font size="2">(08:33:54 PM)</font> <b>robdubya:</b></font> thats what my auth ctrl sample is doing iirc (POST)<br/>
<font color="#A82F2F"><font size="2">(08:34:16 PM)</font> <b>lenswipe:</b></font> oh, so i should be looking in params not query<br/>
<font color="#A82F2F"><font size="2">(08:34:48 PM)</font> <b>robdubya:</b></font> req.body in this case<br/>
<font color="#A82F2F"><font size="2">(08:34:57 PM)</font> <b>lenswipe:</b></font> thank you<br/>
<font color="#A82F2F"><font size="2">(08:35:31 PM)</font> <b>lenswipe:</b></font> robdubya, http://devopsreactions.tumblr.com/post/48683090696/when-you-realize-youre-using-your-own-library-wrong<br/>
<font color="#A82F2F"><font size="2">(08:35:47 PM)</font> <b>robdubya:</b></font> welcome to my life<br/>
<font color="#A82F2F"><font size="2">(08:35:52 PM)</font> <b>lenswipe:</b></font> when I realize im using my own API wrong<br/>
<font color="#A82F2F"><font size="2">(08:54:01 PM)</font> <b>lenswipe:</b></font> also - i saw some mention of token in the code for mySailsSocket<br/>
<font color="#A82F2F"><font size="2">(08:54:30 PM)</font> <b>lenswipe:</b></font> is that implemented yet and how do i use it if so?<br/>
<font color="#A82F2F"><font size="2">(08:55:54 PM)</font> <b>robdubya:</b></font> not implemented<br/>
<font color="#A82F2F"><font size="2">(08:56:09 PM)</font> <b>lenswipe:</b></font> aha<br/>
<font color="#A82F2F"><font size="2">(08:56:12 PM)</font> <b>lenswipe:</b></font> nevermind then<br/>
<font color="#A82F2F"><font size="2">(09:10:15 PM)</font> <b>robdubya:</b></font> trying to work out a cleaner way to do that<br/>
<font color="#A82F2F"><font size="2">(09:10:28 PM)</font> <b>robdubya:</b></font> need to provide an auth hook somehow<br/>
<font color="#A82F2F"><font size="2">(09:31:18 PM)</font> <b>lenswipe:</b></font> indede<br/>
<font color="#A82F2F"><font size="2">(09:31:20 PM)</font> <b>lenswipe:</b></font> indeed*<br/>
<font size="2">(09:57:38 PM)</font><b> delight_ is now known as delight</b><br/>
<font color="#A82F2F"><font size="2">(10:17:00 PM)</font> <b>lenswipe:</b></font> im ffo to bed<br/>
<font color="#A82F2F"><font size="2">(10:17:01 PM)</font> <b>lenswipe:</b></font> night<br/>
<font size="2">(10:17:01 PM)</font><b> lenswipe left the room (quit: Quit: Leaving).</b><br/>
<font color="#A82F2F"><font size="2">(10:40:59 PM)</font> <b>delight__:</b></font> anyone using jade in 0.10 and having succeded calling i18n in the views ?<br/>
<font color="#A82F2F"><font size="2">(10:41:17 PM)</font> <b>delight__:</b></font> doesn&apos;t seem to work :-/<br/>
<font color="#A82F2F"><font size="2">(10:42:06 PM)</font> <b>delight__:</b></font> seems the function is available but something else in there is not initialized correctly<br/>
<font color="#A82F2F"><font size="2">(10:46:24 PM)</font> <b>delight__:</b></font> harr must be somethin else that is breaking it ... :-/<br/>
<font size="2">(10:46:38 PM)</font><b> delight__ left the room (quit: Remote host closed the connection).</b><br/>
<font size="2">(11:01:27 PM)</font><b> The account has disconnected and you are no longer in this chat. You will be automatically rejoined in the chat when the account reconnects.</b><br/>
</body></html>
