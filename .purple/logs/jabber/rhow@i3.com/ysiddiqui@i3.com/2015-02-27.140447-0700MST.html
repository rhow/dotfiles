<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Conversation with ysiddiqui@i3.com at Fri 27 Feb 2015 02:04:47 PM MST on rhow@i3.com/Google (jabber)</title></head><body><h3>Conversation with ysiddiqui@i3.com at Fri 27 Feb 2015 02:04:47 PM MST on rhow@i3.com/Google (jabber)</h3>
<font color="#16569E"><font size="2">(02:04:51 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>hey Ysid!!</span><br/>
<font color="#16569E"><font size="2">(02:05:05 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>you have a minute to swing by ?</span><br/>
<font color="#16569E"><font size="2">(02:19:53 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>select * from public.security_filter where ip_address = '10.0.0.0'<br/><br/>select streaming_id, count(*) from public.security_filter<br/>where deny_access = false<br/>group by streaming_id</span><br/>
<font color="#A82F2F"><font size="2">(02:48:17 PM)</font> <b>Yusuf Siddiqui:</b></font> I think I got the multiple insert thing figured out<br/>
<font color="#16569E"><font size="2">(02:48:33 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>Nice job Ysid!!</span><br/>
<font color="#A82F2F"><font size="2">(03:01:41 PM)</font> <b>Yusuf Siddiqui:</b></font> I think this does the trick:<br/><br/>INSERT INTO security_filter<br/>    (security_zone_id,<br/>     ip_address,<br/>     wildcard_mask,<br/>     deny_access,<br/>     streaming_id,<br/>     comment<br/>    )<br/>SELECT<br/>    1,<br/>    '10.0.0.0',<br/>    '0.255.255.255',<br/>    FALSE,<br/>    streaming_id,<br/>    'internal use'<br/>FROM security_filter<br/>WHERE deny_access = FALSE<br/>GROUP BY streaming_id<br/>
<font color="#16569E"><font size="2">(03:39:14 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>do you know the syntax that's usually used to make it idempotent ?  So if it runs again it won't put another 10.0.0.0 entry into the DB ?</span><br/>
<font color="#A82F2F"><font size="2">(03:39:51 PM)</font> <b>Yusuf Siddiqui:</b></font> probably need to add  a &quot;WHERE NOT EXISTS...&quot;<br/>
<font color="#A82F2F"><font size="2">(03:59:24 PM)</font> <b>Yusuf Siddiqui:</b></font> ok, this looks like it works:<br/><br/><br/>INSERT INTO security_filter<br/>    (security_zone_id,<br/>     ip_address,<br/>     wildcard_mask,<br/>     deny_access,<br/>     streaming_id,<br/>     comment<br/>    )<br/>SELECT<br/>    1,<br/>    '10.0.0.0',<br/>    '0.255.255.255',<br/>    FALSE,<br/>    streaming_id,<br/>    'internal use'<br/>FROM security_filter sf<br/>WHERE deny_access = FALSE<br/>AND streaming_id IS NOT NULL<br/>AND NOT EXISTS<br/>    (SELECT *<br/>     FROM security_filter sf2<br/>     WHERE sf2.streaming_id = sf.streaming_id<br/>     AND ip_address = '10.0.0.0'<br/>     AND wildcard_mask = '0.255.255.255'<br/>     AND deny_access = FALSE<br/>     AND streaming_id IS NOT NULL<br/>    )<br/>GROUP BY streaming_id<br/>
<font color="#A82F2F"><font size="2">(03:59:51 PM)</font> <b>Yusuf Siddiqui:</b></font> If I run it once and then again, it inserts nothing<br/>
<font color="#A82F2F"><font size="2">(04:34:22 PM)</font> <b>Yusuf Siddiqui:</b></font> \\dev-23\D\programs\DD_Database_trunk\DataDoors\Updates\sql\update_mapserver_security_filter.sql<br/>
<font color="#16569E"><font size="2">(04:36:07 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>sweet!  thanks!</span><br/>
<font color="#16569E"><font size="2">(04:36:32 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>do you push that to SVN ?</span><br/>
<font color="#A82F2F"><font size="2">(04:36:47 PM)</font> <b>Yusuf Siddiqui:</b></font> I'm not sure where to put it<br/>
<font color="#16569E"><font size="2">(04:37:49 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>that looked like a good SVN place:<br/>DD_Database_trunk\DataDoors\Updates\sql\update_mapserver_security_filter.sql</span><br/>
<font color="#16569E"><font size="2">(04:39:08 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>either way, i'll get it to Jason, thanks again.</span><br/>
<font color="#A82F2F"><font size="2">(04:41:10 PM)</font> <b>Yusuf Siddiqui:</b></font> There are several scripts with this<br/>
<font color="#16569E"><font size="2">(04:41:31 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>Eh?</span><br/>
<font color="#A82F2F"><font size="2">(04:43:53 PM)</font> <b>Yusuf Siddiqui:</b></font> The 4 scripts I sent to Jakob<br/>
<font color="#16569E"><font size="2">(04:52:36 PM)</font> <b>Randy How:</b></font> <span style='color: #0a841a;'>yeah, this is actually separate from that.</span><br/>
<font color="#A82F2F"><font size="2">(04:53:58 PM)</font> <b>Yusuf Siddiqui:</b></font> oh<br/>
</body></html>
